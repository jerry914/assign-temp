(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-232a3ec8"],{"340d":function(e,t,n){"use strict";n.r(t);n("b0c0"),n("8ba4"),n("a9e3");var c=n("7a23"),r=function(e){return Object(c["N"])("data-v-3392e708"),e=e(),Object(c["L"])(),e},a={class:"page-container"},l=r((function(){return Object(c["n"])("div",{class:"page-title"},"心理師班表",-1)})),i=["innerHTML"],u=Object(c["q"])("可諮商時段"),o={style:{display:"flex"}},b={class:"color-box"},s={key:0,class:"counselor-time-table"};function d(e,t,n,r,d,j){var O=Object(c["T"])("el-table-column"),f=Object(c["T"])("QuestionFilled"),m=Object(c["T"])("el-popover"),p=Object(c["T"])("el-table"),v=Object(c["T"])("el-col"),h=Object(c["T"])("el-row");return Object(c["K"])(),Object(c["m"])("div",a,[l,Object(c["r"])(h,{gutter:20},{default:Object(c["ib"])((function(){return[Object(c["r"])(v,{sm:24,md:12},{default:Object(c["ib"])((function(){return[Object(c["r"])(p,{class:"list-container",data:j.counselors,style:{width:"100%"}},{default:Object(c["ib"])((function(){return[Object(c["r"])(O,{prop:"name",label:"姓名",width:"100"}),Object(c["r"])(O,{prop:"available_time",label:"可諮商時段"},{header:Object(c["ib"])((function(){return[Object(c["r"])(m,{placement:"right",title:"",width:200,trigger:"hover","popper-class":"weektimePop"},{reference:Object(c["ib"])((function(){return[Object(c["n"])("span",null,[u,Object(c["r"])(f,{style:{width:"1em",height:"1em",padding:"0 0 0 3px"}})])]})),default:Object(c["ib"])((function(){return[Object(c["n"])("div",{innerHTML:e.getHtmlContent()},null,8,i)]})),_:1})]})),default:Object(c["ib"])((function(e){return[Object(c["n"])("div",null,Object(c["X"])(e.row.available_time),1)]})),_:1}),j.cases.data?(Object(c["K"])(),Object(c["k"])(O,{key:0,prop:"assign_time",label:"目前排班狀況"},{default:Object(c["ib"])((function(e){return[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(j.getCasesByCounselorId(e.row.id),(function(e){return Object(c["K"])(),Object(c["m"])("div",null,Object(c["X"])(e.consultation_day)+Object(c["X"])(e.consultation_time)+"-"+Object(c["X"])(e.name)+" | "+Object(c["X"])(e.crisis_level),1)})),256))]})),_:1})):Object(c["l"])("",!0)]})),_:1},8,["data"])]})),_:1}),Object(c["r"])(v,{sm:24,md:12},{default:Object(c["ib"])((function(){return[Object(c["n"])("div",o,[Object(c["n"])("div",null,"0/"+Object(c["X"])(d.counselorNum),1),Object(c["n"])("div",b,[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(d.maxNum+1,(function(e){return Object(c["K"])(),Object(c["m"])("div",{class:"color-box-item",style:Object(c["B"])("background-color: rgba(242, 164, 75, "+(e-1)/d.maxNum+");width: "+100/d.maxNum+"%;")},null,4)})),256))]),Object(c["n"])("div",null,Object(c["X"])(d.maxNum)+"/"+Object(c["X"])(d.counselorNum)+" (有排班人數/總人數)",1)]),j.countAvailable().length>1?(Object(c["K"])(),Object(c["m"])("div",s,[Object(c["r"])(h,null,{default:Object(c["ib"])((function(){return[Object(c["r"])(v,{class:"picker-col-lable row-border",span:4}),(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(e.days,(function(e){return Object(c["K"])(),Object(c["k"])(v,{class:"picker-col row-border",span:4},{default:Object(c["ib"])((function(){return[Object(c["q"])(Object(c["X"])(e.label),1)]})),_:2},1024)})),256))]})),_:1}),(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(e.times,(function(t,n){return Object(c["K"])(),Object(c["k"])(h,{class:"picker-row",justify:"space-around",style:Object(c["B"])(Number.isInteger(t.value)?"":"border-top: 2px solid #F2A54B")},{default:Object(c["ib"])((function(){return[Object(c["r"])(v,{class:"picker-col-lable",span:4},{default:Object(c["ib"])((function(){return[Object(c["q"])(Object(c["X"])(t.label),1)]})),_:2},1024),(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(e.days,(function(e,t){return Object(c["K"])(),Object(c["k"])(v,{class:"picker-col",span:4,style:Object(c["B"])("background-color: rgba(242, 164, 75, "+j.countAvailable()[t][n]/d.maxNum+")")},null,8,["style"])})),256))]})),_:2},1032,["style"])})),256))])):Object(c["l"])("",!0)]})),_:1})]})),_:1})])}var j=n("c7eb"),O=n("1da1"),f=(n("d81d"),n("cb29"),n("d3b7"),n("159b"),n("ac1f"),n("1276"),n("4de4"),n("4e82"),n("b3e6")),m={mixins:[f["a"]],data:function(){return{counselorNum:-1,maxNum:0}},created:function(){var e=this;return Object(O["a"])(Object(j["a"])().mark((function t(){return Object(j["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("fetchCounselors");case 2:return t.next=4,e.$store.dispatch("fetchAssignCases");case 4:case"end":return t.stop()}}),t)})))()},computed:{counselors:function(){return this.$store.state.counselors},cases:function(){return this.$store.state.assignCases}},methods:{countAvailable:function(){var e=this;this.counselorNum=this.counselors.length;var t=[this.days.length,this.times.length],n=t[0],c=t[1],r=Array(n).fill().map((function(){return Array(c).fill(0)}));return this.counselors.forEach((function(t){""!=t.available_time&&t.available_time.split(",").forEach((function(t){var n=t.split("");n[0]=parseInt(e.dayRule[n[0]])-1,n[1]=parseInt(e.timeRule[n[1]])-1,r[n[0]][n[1]]?r[n[0]][n[1]]+=1:r[n[0]][n[1]]=1,r[n[0]][n[1]]>e.maxNum&&(e.maxNum=r[n[0]][n[1]])}))})),r},getCasesByCounselorId:function(e){var t=this,n=this.cases.data.filter((function(t){return t.counselor_id==e}));return n.sort((function(e,n){var c=t.dayRule[e.consultation_day],r=t.dayRule[n.consultation_day];return c==r?t.timeRule[e.consultation_time]-t.timeRule[n.consultation_time]:t.dayRule[e.consultation_day]-t.dayRule[n.consultation_day]})),n}}},p=(n("8848"),n("d959")),v=n.n(p);const h=v()(m,[["render",d],["__scopeId","data-v-3392e708"]]);t["default"]=h},"4de4":function(e,t,n){"use strict";var c=n("23e7"),r=n("b727").filter,a=n("1dde"),l=a("filter");c({target:"Array",proto:!0,forced:!l},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"81d5":function(e,t,n){"use strict";var c=n("7b0b"),r=n("23cb"),a=n("07fa");e.exports=function(e){var t=c(this),n=a(t),l=arguments.length,i=r(l>1?arguments[1]:void 0,n),u=l>2?arguments[2]:void 0,o=void 0===u?n:r(u,n);while(o>i)t[i++]=e;return t}},8848:function(e,t,n){"use strict";n("b146")},b146:function(e,t,n){},cb29:function(e,t,n){var c=n("23e7"),r=n("81d5"),a=n("44d2");c({target:"Array",proto:!0},{fill:r}),a("fill")}}]);
//# sourceMappingURL=chunk-232a3ec8.b274b50e.js.map