(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-403f4290"],{"0195":function(e,t,r){"use strict";r("8ba4"),r("a9e3");var n=r("7a23"),i={class:"assignTimePicker"};function o(e,t,r,o,c,a){var l=Object(n["T"])("el-col"),s=Object(n["T"])("el-row");return Object(n["K"])(),Object(n["m"])("div",i,[Object(n["r"])(s,null,{default:Object(n["ib"])((function(){return[Object(n["r"])(l,{class:"picker-col-lable row-border",span:4}),(Object(n["K"])(!0),Object(n["m"])(n["b"],null,Object(n["R"])(e.days,(function(e){return Object(n["K"])(),Object(n["k"])(l,{class:"picker-col row-border",span:4},{default:Object(n["ib"])((function(){return[Object(n["q"])(Object(n["X"])(e.label),1)]})),_:2},1024)})),256))]})),_:1}),(Object(n["K"])(!0),Object(n["m"])(n["b"],null,Object(n["R"])(e.times,(function(t,r){return Object(n["K"])(),Object(n["k"])(s,{class:"picker-row",justify:"space-around",style:Object(n["B"])(Number.isInteger(t.value)?"":"border-top: 2px solid #F2A54B")},{default:Object(n["ib"])((function(){return[Object(n["r"])(l,{class:"picker-col-lable",span:4},{default:Object(n["ib"])((function(){return[Object(n["q"])(Object(n["X"])(t.label),1)]})),_:2},1024),(Object(n["K"])(!0),Object(n["m"])(n["b"],null,Object(n["R"])(e.days,(function(e,r){return Object(n["K"])(),Object(n["k"])(l,{class:"picker-col pickable",span:4,onMouseenter:a.mouseEnter,onMouseleave:a.mouseLeave,onMousedown:function(r){return a.mouseDown(r,e.value+t.value)},onMouseup:a.mouseUp,onMousemove:function(r){return a.mouseMove(r,e.value+t.value)}},null,8,["onMouseenter","onMouseleave","onMousedown","onMouseup","onMousemove"])})),256))]})),_:2},1032,["style"])})),256))])}r("ac1f"),r("1276"),r("a434"),r("4e82"),r("a15b");var c=r("b3e6"),a={mixins:[c["a"]],props:{modelValue:String},emits:["update:modelValue"],data:function(){return{mousepressed:!1,mousepop:!1,selectedTime:[]}},watch:{modelValue:function(){this.createBlock()}},mounted:function(){this.createBlock()},methods:{createBlock:function(){if(this.modelValue){var e=this.modelValue.split(",");if(e.length>1){this.clearBlock(),this.selectedTime=[];for(var t=0;t<e.length;t++){this.selectedTime.push(e[t]);var r=e[t].split("");r[0]=parseInt(this.dayRule[r[0]])-1,r[1]=parseInt(this.timeRule[r[1]])-1;var n=document.getElementsByClassName("pickable");n[r[0]+5*r[1]].classList.add("picked")}}}},clearBlock:function(){for(var e=document.getElementsByClassName("pickable"),t=0;t<e.length;t++)e[t].classList.remove("picked");this.selectedTime=[]},mouseEnter:function(){},mouseLeave:function(){this.mousepop=!1},mouseDown:function(e,t){this.mousepressed=!0,this.handleTime(e,t)},mouseUp:function(){this.mousepressed=!1},mouseMove:function(e,t){this.mousepressed&&!this.mousepop&&this.handleTime(e,t)},handleTime:function(e,t){var r=this;if(e.target.classList.toggle("picked"),e.target.classList.contains("picked"))this.selectedTime.push(t);else{var n=this.selectedTime.indexOf(t);n>-1&&this.selectedTime.splice(n,1)}this.selectedTime.sort((function(e,t){var n=e.split(""),i=t.split("");return n[0]=r.dayRule[n[0]],i[0]=r.dayRule[i[0]],n[0]==i[0]?r.timeRule[n[1]]-r.timeRule[i[1]]:n[0]-i[0]})),this.mousepop=!0,this.$emit("update:modelValue",this.selectedTime.join(","))}}},l=(r("6b41"),r("d959")),s=r.n(l);const u=s()(a,[["render",o],["__scopeId","data-v-747e61ea"]]);t["a"]=u},"4de4":function(e,t,r){"use strict";var n=r("23e7"),i=r("b727").filter,o=r("1dde"),c=o("filter");n({target:"Array",proto:!0,forced:!c},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"6b41":function(e,t,r){"use strict";r("e562")},"72b1":function(e,t,r){"use strict";r.r(t);r("b0c0");var n=r("7a23"),i=function(e){return Object(n["N"])("data-v-1136a20e"),e=e(),Object(n["L"])(),e},o={class:"page-container"},c=i((function(){return Object(n["n"])("div",{class:"page-title"},"值日端-修改個案",-1)})),a={class:"radius-box"},l=Object(n["q"])("取消"),s=Object(n["q"])("儲存"),u={class:"dialog-footer",slot:"footer",style:{"text-align":"center"}},d=Object(n["q"])("確定");function f(e,t,r,i,f,b){var m=Object(n["T"])("el-input"),p=Object(n["T"])("el-form-item"),j=Object(n["T"])("assignTimePicker"),h=Object(n["T"])("el-col"),O=Object(n["T"])("el-option"),g=Object(n["T"])("el-select"),_=Object(n["T"])("el-autocomplete"),v=Object(n["T"])("el-date-picker"),T=Object(n["T"])("el-button"),k=Object(n["T"])("el-row"),V=Object(n["T"])("el-form"),y=Object(n["T"])("el-result"),w=Object(n["T"])("el-dialog");return Object(n["K"])(),Object(n["m"])("div",o,[c,Object(n["r"])(V,{model:f.form,rules:f.rules,ref:"form","label-width":"100px"},{default:Object(n["ib"])((function(){return[Object(n["r"])(k,null,{default:Object(n["ib"])((function(){return[Object(n["r"])(h,{sm:24,md:12},{default:Object(n["ib"])((function(){return[Object(n["r"])(p,{label:"姓名",prop:"name"},{default:Object(n["ib"])((function(){return[Object(n["r"])(m,{class:"input-container",placeholder:"請輸入姓名",modelValue:f.form.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return f.form.name=e})},null,8,["modelValue"])]})),_:1}),Object(n["r"])(p,{label:"學號",prop:"caseId"},{default:Object(n["ib"])((function(){return[Object(n["r"])(m,{class:"input-container",placeholder:"請輸入學號",modelValue:f.form.caseId,"onUpdate:modelValue":t[1]||(t[1]=function(e){return f.form.caseId=e})},null,8,["modelValue"])]})),_:1}),Object(n["r"])(p,{label:"可諮商時段",prop:"available_time"},{default:Object(n["ib"])((function(){return[Object(n["n"])("div",a,[Object(n["r"])(j,{modelValue:f.form.available_time,"onUpdate:modelValue":t[2]||(t[2]=function(e){return f.form.available_time=e}),ref:"timePicker"},null,8,["modelValue"])])]})),_:1})]})),_:1}),Object(n["r"])(h,{sm:24,md:12},{default:Object(n["ib"])((function(){return[Object(n["r"])(p,{label:"危機程度",prop:"crisis_level"},{default:Object(n["ib"])((function(){return[Object(n["r"])(g,{class:"input-container",placeholder:"請輸入危機程度",modelValue:f.form.crisis_level,"onUpdate:modelValue":t[3]||(t[3]=function(e){return f.form.crisis_level=e})},{default:Object(n["ib"])((function(){return[(Object(n["K"])(!0),Object(n["m"])(n["b"],null,Object(n["R"])(f.crisis_options,(function(e){return Object(n["K"])(),Object(n["k"])(O,{key:e,label:e,value:e},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(n["r"])(p,{label:"初談老師",prop:"init_counselor_name"},{default:Object(n["ib"])((function(){return[Object(n["r"])(_,{class:"input-container",modelValue:f.form.init_counselor_name,"onUpdate:modelValue":t[4]||(t[4]=function(e){return f.form.init_counselor_name=e}),"fetch-suggestions":e.querySearch,placeholder:"請輸入初談老師"},null,8,["modelValue","fetch-suggestions"])]})),_:1}),Object(n["r"])(p,{label:"狀況說明",prop:"discription"},{default:Object(n["ib"])((function(){return[Object(n["r"])(m,{class:"input-container",type:"textarea",placeholder:"請輸入狀況說明",autosize:{minRows:3,maxRows:6},modelValue:f.form.discription,"onUpdate:modelValue":t[5]||(t[5]=function(e){return f.form.discription=e})},null,8,["modelValue"])]})),_:1}),Object(n["r"])(p,{label:"初談時間",prop:"created_date"},{default:Object(n["ib"])((function(){return[Object(n["r"])(v,{modelValue:f.form.created_date,"onUpdate:modelValue":t[6]||(t[6]=function(e){return f.form.created_date=e}),type:"date"},null,8,["modelValue"])]})),_:1}),Object(n["r"])(k,null,{default:Object(n["ib"])((function(){return[Object(n["r"])(h,{span:4,offset:12},{default:Object(n["ib"])((function(){return[Object(n["r"])(T,{type:"danger",onClick:b.cancelForm},{default:Object(n["ib"])((function(){return[l]})),_:1},8,["onClick"])]})),_:1}),Object(n["r"])(h,{span:4},{default:Object(n["ib"])((function(){return[Object(n["r"])(T,{type:"primary",onClick:t[7]||(t[7]=function(e){return b.submitForm("form")})},{default:Object(n["ib"])((function(){return[s]})),_:1})]})),_:1})]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["model","rules"]),Object(n["r"])(w,{title:"狀態",modelValue:f.dialogVisible,"onUpdate:modelValue":t[9]||(t[9]=function(e){return f.dialogVisible=e}),width:"30%",onClose:b.handleClose,center:""},{default:Object(n["ib"])((function(){return[Object(n["r"])(y,{icon:"success",title:"儲存成功",subTitle:"點擊確定關閉提示"}),Object(n["n"])("div",u,[Object(n["r"])(T,{type:"primary",onClick:t[8]||(t[8]=function(e){return f.dialogVisible=!1})},{default:Object(n["ib"])((function(){return[d]})),_:1})])]})),_:1},8,["modelValue","onClose"])])}r("ac1f"),r("1276");var b=r("0195"),m=r("c343"),p={mixins:[m["a"]],name:"modifyCase",components:{assignTimePicker:b["a"]},data:function(){return{form:{caseId:"107000000",name:"同學A",available_time:"M1,F2",crisis_level:"C",init_counselor_name:"心理師1",discription:"無",created_date:"2022-7-6"},crisis_options:["A+","A","A-","B+","B","B-","C"],rules:{name:[{required:!0,message:"請輸入姓名",trigger:"blur"}],id:[{required:!0,message:"請輸入學號",trigger:"blur"}],available_time:[{required:!0,message:"請選擇時段",trigger:"blur"}],crisis_level:[{required:!0,message:"請選擇危機程度",trigger:"blur"}],created_date:[{required:!0,message:"請選擇日期",trigger:"blur"}],init_counselor_name:[{required:!0,message:"請輸入初談老師",trigger:"change"}]},dialogVisible:!1}},created:function(){this.getCase()},methods:{getCase:function(){var e=this;this.$http.get("/api/cases/"+this.$route.params.id).then((function(t){e.form=t.data.data[0],e.form.created_date=e.form.created_date.split("T")[0]})).catch((function(e){console.log(e)}))},putCase:function(e){var t=this;console.log(this.form.created_date);try{this.form.created_date=this.getDateStr(this.form.created_date)}catch(r){console.log(r),this.form.created_date=this.form.created_date.split("T")[0]}this.$http.put("/api/cases/"+e,{caseId:this.form.caseId,name:this.form.name,available_time:this.form.available_time,crisis_level:this.form.crisis_level,init_counselor_name:this.form.init_counselor_name,discription:""==this.form.discription?"無":this.form.discription,created_date:this.form.created_date}).then((function(e){console.log(e.data.message),t.dialogVisible=!0,t.$store.dispatch("fetchUnassignCases"),t.$store.commit("SET_STATUS","end")})).catch((function(e){console.log(e)}))},getDateStr:function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" 08:00:00.000"},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.$store.commit("SET_STATUS","pending"),t.putCase(t.$route.params.id)}))},resetForm:function(e){this.$refs[e].resetFields(),this.$refs.timePicker.clearBlock()},handleClose:function(){console.log("finish modify")},cancelForm:function(){this.$router.push("/listCases")}}},j=(r("9d34"),r("d959")),h=r.n(j);const O=h()(p,[["render",f],["__scopeId","data-v-1136a20e"]]);t["default"]=O},"9d34":function(e,t,r){"use strict";r("cc26")},a15b:function(e,t,r){"use strict";var n=r("23e7"),i=r("e330"),o=r("44ad"),c=r("fc6a"),a=r("a640"),l=i([].join),s=o!=Object,u=a("join",",");n({target:"Array",proto:!0,forced:s||!u},{join:function(e){return l(c(this),void 0===e?",":e)}})},a434:function(e,t,r){"use strict";var n=r("23e7"),i=r("7b0b"),o=r("23cb"),c=r("5926"),a=r("07fa"),l=r("3511"),s=r("65f0"),u=r("8418"),d=r("083a"),f=r("1dde"),b=f("splice"),m=Math.max,p=Math.min;n({target:"Array",proto:!0,forced:!b},{splice:function(e,t){var r,n,f,b,j,h,O=i(this),g=a(O),_=o(e,g),v=arguments.length;for(0===v?r=n=0:1===v?(r=0,n=g-_):(r=v-2,n=p(m(c(t),0),g-_)),l(g+r-n),f=s(O,n),b=0;b<n;b++)j=_+b,j in O&&u(f,b,O[j]);if(f.length=n,r<n){for(b=_;b<g-n;b++)j=b+n,h=b+r,j in O?O[h]=O[j]:d(O,h);for(b=g;b>g-n+r;b--)d(O,b-1)}else if(r>n)for(b=g-n;b>_;b--)j=b+n-1,h=b+r-1,j in O?O[h]=O[j]:d(O,h);for(b=0;b<r;b++)O[b+_]=arguments[b+2];return O.length=g-n+r,f}})},c343:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("d3b7"),r("159b"),r("b0c0"),r("4de4");var n={data:function(){return{}},created:function(){this.$store.state.counselors.length<=0&&this.$store.dispatch("fetchCounselors")},methods:{querySearch:function(e,t){var r=this.$store.state.counselors;r.forEach((function(e){e.value=e.name}));var n=e?r.filter(this.createFilter(e)):r;t(n)},createFilter:function(e){return function(t){return t.value.toLowerCase().indexOf(e.toLowerCase())>=0}}}}},cc26:function(e,t,r){},e562:function(e,t,r){}}]);
//# sourceMappingURL=chunk-403f4290.0b899e6b.js.map