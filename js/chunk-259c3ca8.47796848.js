(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-259c3ca8"],{"494e":function(t,e,n){},"4a33":function(t,e,n){},"4d36":function(t,e,n){"use strict";n.r(e);var c=n("7a23"),s=function(t){return Object(c["N"])("data-v-824c058c"),t=t(),Object(c["L"])(),t},i={class:"page-container"},a=s((function(){return Object(c["n"])("div",{class:"page-title"},"派案列表",-1)})),l=Object(c["q"])("下載派案列表"),r=s((function(){return Object(c["n"])("strong",null,"操作方式",-1)})),o=s((function(){return Object(c["n"])("div",null,"點擊時段可以查看更詳細排班情況",-1)})),u=s((function(){return Object(c["n"])("br",null,null,-1)})),b=s((function(){return Object(c["n"])("strong",null,"方塊顏色意義",-1)})),O=s((function(){return Object(c["n"])("div",null,"灰色空格：心理師此時段為有空",-1)})),j=s((function(){return Object(c["n"])("div",null,"藍色實心：心理師此時段已有排到個案，並且諮商次數為0~6次",-1)})),d=s((function(){return Object(c["n"])("div",null,"紅色實心：心理師此時段已有排到個案，並且諮商次數為7~14次",-1)})),f=s((function(){return Object(c["n"])("div",null,"紫色實心：心理師此時段已有排到個案，並且諮商次數為15次以上",-1)})),g={class:"timetable-info"},m=Object(c["q"])("操作說明"),h={class:"result-table"},v={class:"result-aside"},_=s((function(){return Object(c["n"])("div",{style:{width:"100px",height:"1.3em","font-size":"0.9em","text-align":"center"}},"時段 \\ 日期",-1)})),w={class:"result-aside-label"},p={class:"result-table-inner"},k={class:"result-header"},y={class:"result-body"},D={class:"result-body-row"};function L(t,e,n,s,L,K){var N=Object(c["T"])("el-col"),X=Object(c["T"])("el-button"),A=Object(c["T"])("download-excel"),x=Object(c["T"])("el-row"),C=Object(c["T"])("InfoFilled"),R=Object(c["T"])("el-popover"),T=Object(c["T"])("resultBlock"),F=Object(c["U"])("loading");return Object(c["K"])(),Object(c["m"])("div",i,[Object(c["r"])(x,null,{default:Object(c["ib"])((function(){return[Object(c["r"])(N,{span:12},{default:Object(c["ib"])((function(){return[a]})),_:1}),Object(c["r"])(N,{span:12},{default:Object(c["ib"])((function(){return[Object(c["r"])(A,{data:K.downloadXLS(),fields:t.json_fields,name:"派案列表"+K.getDateStr(0)+".xls"},{default:Object(c["ib"])((function(){return[Object(c["r"])(X,{type:"success",size:"medium",style:{float:"right","margin-top":"30px"}},{default:Object(c["ib"])((function(){return[l]})),_:1})]})),_:1},8,["data","fields","name"])]})),_:1})]})),_:1}),Object(c["r"])(R,{placement:"bottom",title:"",width:400,trigger:"hover"},{reference:Object(c["ib"])((function(){return[Object(c["n"])("span",g,[m,Object(c["r"])(C,{style:{width:"1em",height:"1em",padding:"0 0 0 3px"}})])]})),default:Object(c["ib"])((function(){return[r,o,u,b,O,j,d,f]})),_:1}),Object(c["n"])("div",h,[Object(c["n"])("div",v,[_,(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(t.times,(function(t,e){return Object(c["K"])(),Object(c["m"])("div",w,Object(c["X"])(t.label),1)})),256))]),Object(c["jb"])((Object(c["K"])(),Object(c["m"])("div",p,[Object(c["n"])("div",k,[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(K.getWeekAry(),(function(t){return Object(c["K"])(),Object(c["m"])("div",{class:Object(c["A"])(["result-header-col",K.isWeekend(t)?"strong-row":""])},Object(c["X"])(K.checkOffsetIsHoliday(t)?"假日":K.getDatetime(t)),3)})),256))]),Object(c["n"])("div",y,[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(t.times,(function(e,n){return Object(c["K"])(),Object(c["m"])("div",D,[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(K.getWeekAry(),(function(n){return Object(c["K"])(),Object(c["m"])("div",{class:Object(c["A"])(["result-body-col",K.isWeekend(n)?"strong-row":""])},[t.timetable[n%7]&&!K.checkOffsetIsHoliday(n)?(Object(c["K"])(),Object(c["m"])(c["b"],{key:0},[t.timetable[n%7].rows[e.value]?(Object(c["K"])(),Object(c["k"])(T,{key:0,results:t.timetable[n%7].rows[e.value].counselors,offset:n},null,8,["results","offset"])):Object(c["l"])("",!0)],64)):Object(c["l"])("",!0)],2)})),256))])})),256))])])),[[F,t.tableLoading]])])])}var K=n("c7eb"),N=n("1da1"),X=(n("d3b7"),n("159b"),n("7db0"),n("b0c0"),n("ac1f"),n("1276"),function(t){return Object(c["N"])("data-v-32bf13bc"),t=t(),Object(c["L"])(),t}),A={class:"resultBlock"},x=Object(c["q"])("未派案"),C={class:"content-title"},R=X((function(){return Object(c["n"])("div",null,"無資料",-1)})),T=Object(c["q"])("已派案"),F={class:"content-title",style:{color:"#F0F2F5"}},M={style:{color:"#F0F2F5"}},I=X((function(){return Object(c["n"])("br",null,null,-1)})),q={key:0,class:"block-container"},B={key:0,class:"more-block"},W={key:1,class:"block-container"},S={key:0,class:"more-block"},H={key:2,class:"block-container"},$={key:0,class:"more-block"},E={key:1,class:"more-block"};function U(t,e,n,s,i,a){var l=Object(c["T"])("el-col"),r=Object(c["T"])("el-row"),o=Object(c["T"])("el-popover");return Object(c["K"])(),Object(c["m"])("div",A,[Object(c["r"])(o,{placement:n.offset<10?"right":"left",title:a.getDatetime(n.offset),width:300,trigger:"click","hide-after":0},{reference:Object(c["ib"])((function(){return[i.unassignList.length<=0?(Object(c["K"])(),Object(c["m"])("div",q,[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(i.assignList,(function(t,e){return Object(c["jb"])((Object(c["K"])(),Object(c["m"])("div",{class:Object(c["A"])(["divide-block-colored",a.getColor(a.addOffset(t.first_consultation_date))]),style:Object(c["B"])(i.assignList.length>i.showNum?"width: "+100/i.showNum+"%":"width: "+100/i.assignList.length+"%")},Object(c["X"])(t.counselor_name),7)),[[c["fb"],e<i.showNum]])})),256)),i.assignList.length>i.showNum?(Object(c["K"])(),Object(c["m"])("div",B,"+"+Object(c["X"])(i.assignList.length-i.showNum),1)):Object(c["l"])("",!0)])):i.assignList<=0?(Object(c["K"])(),Object(c["m"])("div",W,[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(i.unassignList,(function(t,e){return Object(c["jb"])((Object(c["K"])(),Object(c["m"])("div",{class:"divide-block",style:Object(c["B"])(i.unassignList.length>i.showNum?"width: "+100/i.showNum+"%":"width: "+100/i.unassignList.length+"%")},Object(c["X"])(t),5)),[[c["fb"],e<i.showNum]])})),256)),i.unassignList.length>i.showNum?(Object(c["K"])(),Object(c["m"])("div",S,"+"+Object(c["X"])(i.unassignList.length-i.showNum),1)):Object(c["l"])("",!0)])):(Object(c["K"])(),Object(c["m"])("div",H,[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(i.unassignList,(function(t,e){return Object(c["jb"])((Object(c["K"])(),Object(c["m"])("div",{class:"divide-block",style:Object(c["B"])(i.unassignList.length>i.showNum?"width: "+100/i.showNum+"0%":"width: "+100/i.unassignList.length+"%")},Object(c["X"])(t),5)),[[c["fb"],e<i.showNum]])})),256)),i.unassignList.length>i.showNum?(Object(c["K"])(),Object(c["m"])("div",$,"+"+Object(c["X"])(i.unassignList.length-i.showNum+i.assignList.length),1)):(Object(c["K"])(),Object(c["m"])("div",E,"+"+Object(c["X"])(i.assignList.length),1))]))]})),default:Object(c["ib"])((function(){return[Object(c["r"])(r,{class:"content-container",align:"middle"},{default:Object(c["ib"])((function(){return[Object(c["r"])(l,{class:"content-label",span:2},{default:Object(c["ib"])((function(){return[x]})),_:1}),Object(c["r"])(l,{span:22},{default:Object(c["ib"])((function(){return[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(i.unassignList,(function(t,e){return Object(c["K"])(),Object(c["k"])(r,{align:"middle"},{default:Object(c["ib"])((function(){return[Object(c["r"])(l,{class:"content-idx",span:2},{default:Object(c["ib"])((function(){return[Object(c["q"])(Object(c["X"])(e+1),1)]})),_:2},1024),Object(c["r"])(l,{class:"content",span:22},{default:Object(c["ib"])((function(){return[Object(c["n"])("div",C,Object(c["X"])(t),1),R]})),_:2},1024)]})),_:2},1024)})),256))]})),_:1})]})),_:1}),Object(c["r"])(r,{class:"content-container",align:"middle"},{default:Object(c["ib"])((function(){return[Object(c["r"])(l,{class:"content-label",span:2},{default:Object(c["ib"])((function(){return[T]})),_:1}),Object(c["r"])(l,{span:22},{default:Object(c["ib"])((function(){return[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(i.assignList,(function(t,e){return Object(c["K"])(),Object(c["k"])(r,{align:"middle"},{default:Object(c["ib"])((function(){return[Object(c["r"])(l,{class:Object(c["A"])(["content-idx",a.getColor(a.addOffset(t.first_consultation_date))]),span:2,style:{"line-height":"70px"}},{default:Object(c["ib"])((function(){return[Object(c["q"])(Object(c["X"])(e+1),1)]})),_:2},1032,["class"]),Object(c["r"])(l,{class:Object(c["A"])(["content",a.getColor(a.addOffset(t.first_consultation_date))]),span:22,style:{height:"70px"}},{default:Object(c["ib"])((function(){return[Object(c["n"])("div",F,Object(c["X"])(t.counselor_name),1),Object(c["n"])("div",M,[Object(c["q"])(Object(c["X"])(t.name)+" "+Object(c["X"])(t.caseId),1),I,Object(c["q"])("諮商次數："+Object(c["X"])(a.addOffset(t.first_consultation_date)),1)])]})),_:2},1032,["class"])]})),_:2},1024)})),256))]})),_:1})]})),_:1})]})),_:1},8,["placement","title"])])}var z=n("b3e6"),J={mixins:[z["a"]],props:["results","offset"],data:function(){return{unassignList:[],assignList:[],showNum:3}},mounted:function(){for(var t in this.results)if("unassign"==this.results[t])this.unassignList.push(t);else if(this.checkRangeDay(this.offset,this.results[t].end_consultation_date,this.results[t].first_consultation_date,this.results[t].status)){var e=this.results[t];this.assignList.push(e)}else this.unassignList.push(t)},methods:{getColor:function(t){return t>=15?"purple-block":t>=7?"red-block":t>=0?"blue-block":"gray-block"},getDatetime:function(t){var e=["（日）","（ㄧ）","（二）","（三）","（四）","（五）","（六）"],n=new Date;n.setDate(n.getDate()+t);var c=n.getFullYear()+" / "+(n.getMonth()+1)+" / "+n.getDate()+"  "+e[n.getDay()];return c},addOffset:function(t){var e=new Date;return e.setDate(e.getDate()+this.offset),this.countConsultationNumber(e,t)}}},Y=(n("fb14"),n("d959")),G=n.n(Y);const P=G()(J,[["render",U],["__scopeId","data-v-32bf13bc"]]);var Q=P,V=n("2ef0"),Z=n.n(V),tt={mixins:[z["a"]],components:{resultBlock:Q},data:function(){return{assignCases:[{caseId:"108000000",name:"同學A",available_time:"M1,M2,M3",crisis_level:"A",discription:"狀態說明超過10字會簡化，滑鼠移到文字上方顯示彈出框",created_date:"2022/7/6",init_counselor_name:"心理師A",status:"assign",counselor_name:"心理師A",consultation_day:"M",consultation_time:"2",counselor_id:"1"}],counselors:[{id:"1",name:"心理師A",available_time:"M1,M2"},{id:"2",name:"心理師B",available_time:"M1,M2,F1,F2"}],timetable:{},dayList:[],tableLoading:!1,json_fields:{"姓名":"name","學號":"caseId","諮商時段":"consultation_datetime","派案老師":"counselor_name","諮商開始時間":"first_consultation_date","危機程度":"crisis_level","初談老師":"init_counselor_name","狀態說明":"discription","初談時間":"created_date"}}},created:function(){var t=this;return Object(N["a"])(Object(K["a"])().mark((function e(){return Object(K["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.tableLoading=!0,e.next=3,t.$store.dispatch("fetchAssignCases");case 3:return e.next=5,t.$store.dispatch("fetchCounselors");case 5:t.createResultTable(),t.tableLoading=!1,console.log(t.timetable);case 8:case"end":return e.stop()}}),e)})))()},methods:{createResultTable:function(){var t=this;this.assignCases=Z.a.cloneDeep(this.$store.state.assignCases.data),this.counselors=this.$store.state.counselors,console.log(this.assignCases),this.timetable={};for(var e=function(e){c=["U","M","T","W","R","F","S"],s=new Date,s.setDate(s.getDate()+e);var n=c[s.getDay()];"U"!=n&&"S"!=n&&(t.dayList.push({name:n,offset:e}),t.timetable[e]={rows:{}},t.counselors.forEach((function(c){var s=c.available_time.split(",");s.forEach((function(s){s.indexOf(n)>=0&&(t.timetable[e].rows[s.charAt(1)]||(t.timetable[e].rows[s.charAt(1)]={counselors:{}}),t.timetable[e].rows[s.charAt(1)].counselors[c.name]="unassign")}))})))},n=0;n<=7;n++){var c,s;e(n)}this.assignCases.forEach((function(e){var n=t.dayList.find((function(t){return t.name==e.consultation_day}));t.timetable[n.offset].rows[e.consultation_time].counselors[e.counselor_name]=e}))},isWeekend:function(t){var e=new Date;return e.setDate(e.getDate()+t),5==e.getDay()},getDatetime:function(t){var e=["（日）","（ㄧ）","（二）","（三）","（四）","（五）","（六）"],n=new Date;n.setDate(n.getDate()+t);var c=n.getMonth()+1+" / "+n.getDate()+"  "+e[n.getDay()];return c},getDateStr:function(t){var e=new Date;return e.setDate(e.getDate()+t),e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},getWeekAry:function(){for(var t=[],e=new Date,n=1;n<85;n++){var c=new Date;c.setDate(e.getDate()+n),0!=c.getDay()&&6!=c.getDay()&&t.push(n)}return t},downloadXLS:function(){for(var t=this,e=Z.a.cloneDeep(this.assignCases),n=function(n){e[n].consultation_datetime="星期"+t.days.find((function(t){return t.value==e[n].consultation_day})).label+" "+t.times.find((function(t){return t.value==e[n].consultation_time})).label},c=0;c<e.length;c++)n(c);return e},checkOffsetIsHoliday:function(t){var e=new Date;return e.setDate(e.getDate()+t),this.checkHoliday(e)}}};n("c7a6");const et=G()(tt,[["render",L],["__scopeId","data-v-824c058c"]]);e["default"]=et},c7a6:function(t,e,n){"use strict";n("4a33")},fb14:function(t,e,n){"use strict";n("494e")}}]);
//# sourceMappingURL=chunk-259c3ca8.47796848.js.map